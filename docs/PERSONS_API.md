# Persons API æ–‡æ¡£

äººè„¸ç‰¹å¾ç®¡ç†æ¥å£çš„å®Œæ•´è¯´æ˜æ–‡æ¡£ã€‚

---

## ğŸ“‹ ç›®å½•

- [æ¥å£æ¦‚è§ˆ](#æ¥å£æ¦‚è§ˆ)
- [åˆ›å»ºäººç‰©](#åˆ›å»ºäººç‰©)
- [æ‰¹é‡åˆ›å»º](#æ‰¹é‡åˆ›å»º)
- [æŸ¥è¯¢äººç‰©](#æŸ¥è¯¢äººç‰©)
- [æœç´¢äººç‰©](#æœç´¢äººç‰©)
- [åˆ é™¤äººç‰©](#åˆ é™¤äººç‰©)
- [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)

---

## æ¥å£æ¦‚è§ˆ

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/persons` | åˆ›å»ºæˆ–æ›´æ–°å•ä¸ªäººç‰©ç‰¹å¾ |
| POST | `/persons/batch` | æ‰¹é‡åˆ›å»ºæˆ–æ›´æ–°äººç‰©ç‰¹å¾ |
| GET | `/persons` | è·å–äººç‰©åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰ |
| POST | `/persons/search` | æœç´¢äººç‰©ï¼ˆæ”¯æŒæ¨¡ç³Š/ç²¾ç¡®ï¼‰ |
| DELETE | `/persons/delete` | é€šç”¨åˆ é™¤æ¥å£ï¼ˆæ”¯æŒ name/number/idï¼‰ |

---

## åˆ›å»ºäººç‰©

### `POST /persons`

åˆ›å»ºæˆ–æ›´æ–°å•ä¸ªäººç‰©çš„äººè„¸ç‰¹å¾ã€‚

**åŠŸèƒ½è¯´æ˜**ï¼š
- å¦‚æœ `number` å·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°è¯¥äººç‰©ä¿¡æ¯
- å¦‚æœ `number` ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°äººç‰©
- è‡ªåŠ¨æ£€æµ‹äººè„¸ã€æå–ç‰¹å¾ã€ä¿å­˜å›¾ç‰‡

**è¯·æ±‚ä½“**ï¼š

```json
{
  "name": "å¼ ä¸‰",
  "number": "001",
  "photo": "data:image/jpeg;base64,/9j/4AAQSkZJRg..."
}
```

**å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | æ˜¯ | äººç‰©å§“å |
| number | string | æ˜¯ | äººç‰©ç¼–å·ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰ |
| photo | string | æ˜¯ | Base64ç¼–ç çš„å›¾ç‰‡æ•°æ® |

**æˆåŠŸå“åº”** (200):

```json
{
  "id": "507f1f77bcf86cd799439011",
  "name": "å¼ ä¸‰",
  "number": "001",
  "photo_path": "/media/person_photos/å¼ ä¸‰_001_a3b4c5d6.jpg",
  "tip": "äººè„¸ç‰¹å¾åƒç´ æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨"
}
```

**å“åº”å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | string | MongoDBæ–‡æ¡£ID |
| name | string | äººç‰©å§“å |
| number | string | äººç‰©ç¼–å· |
| photo_path | string | ä¿å­˜çš„äººè„¸å›¾ç‰‡è·¯å¾„ |
| tip | string | å›¾åƒè´¨é‡æç¤ºä¿¡æ¯ |

**é”™è¯¯å“åº”**ï¼š

| çŠ¶æ€ç  | è¯´æ˜ | è¿”å›ç¤ºä¾‹ |
|--------|------|---------|
| 400 | æ— æ•ˆçš„å›¾ç‰‡æ•°æ® | `{"detail": "æœªæ¥æ”¶åˆ°æœ‰æ•ˆå›¾ç‰‡æ•°æ®æˆ–å›¾åƒæ•°æ®å­˜åœ¨å¼‚å¸¸"}` |
| 422 | æœªæ£€æµ‹åˆ°äººè„¸ | `{"detail": "æœªæ£€æµ‹åˆ°æœ‰æ•ˆäººè„¸"}` |
| 422 | äººè„¸è¿‡å° | `{"detail": "æ£€æµ‹åˆ°çš„äººè„¸è¿‡å°(å°äº80*80px)ï¼Œæ— æ³•è¯†åˆ«ï¼Œè¯·é‡æ–°æ•æ‰äººè„¸"}` |
| 500 | äººè„¸æ£€æµ‹æœåŠ¡é”™è¯¯ | `{"detail": "äººè„¸æ£€æµ‹æœåŠ¡å†…éƒ¨é”™è¯¯: ..."}` |
| 500 | ç‰¹å¾æå–å¤±è´¥ | `{"detail": "äººè„¸ç‰¹å¾æå–å¤±è´¥: ..."}` |
| 500 | ä¿å­˜å›¾ç‰‡å¤±è´¥ | `{"detail": "ä¿å­˜å›¾ç‰‡å¤±è´¥: ..."}` |
| 500 | æ•°æ®åº“æ“ä½œå¤±è´¥ | `{"detail": "æ•°æ®åº“æ“ä½œå¤±è´¥: ..."}` |
| 500 | å…¶ä»–æœªé¢„æœŸå¼‚å¸¸ | `{"detail": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯: ..."}` |

---

## æ‰¹é‡åˆ›å»º

### `POST /persons/batch`

æ‰¹é‡ä¸Šä¼ å¤šä¸ªäººç‰©çš„äººè„¸ç‰¹å¾ã€‚

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ¥å—å¤šä¸ªäººç‰©ä¿¡æ¯
- **å…¨éƒ¨æˆåŠŸæ‰è¿”å› 200**
- **ä»»ä½•ä¸€æ¡å¤±è´¥éƒ½æŠ›å‡º 400 å¼‚å¸¸**
- å¼‚å¸¸ä¿¡æ¯åŒ…å«æˆåŠŸ/å¤±è´¥ç»Ÿè®¡å’Œè¯¦ç»†é”™è¯¯

**è¯·æ±‚ä½“**ï¼š

```json
{
  "persons": [
    {
      "name": "å¼ ä¸‰",
      "number": "001",
      "photo": "data:image/jpeg;base64,/9j/4AAQ..."
    },
    {
      "name": "æå››",
      "number": "002",
      "photo": "data:image/jpeg;base64,/9j/4AAQ..."
    }
  ]
}
```

**æˆåŠŸå“åº”** (200):

```json
{
  "persons": [
    {
      "id": "507f1f77bcf86cd799439011",
      "name": "å¼ ä¸‰",
      "number": "001",
      "photo_path": "/media/person_photos/å¼ ä¸‰_001_a3b4c5d6.jpg",
      "tip": "äººè„¸ç‰¹å¾åƒç´ æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨"
    },
    {
      "id": "507f1f77bcf86cd799439012",
      "name": "æå››",
      "number": "002",
      "photo_path": "/media/person_photos/æå››_002_b7c8d9e0.jpg",
      "tip": "äººè„¸ç‰¹å¾åƒç´ æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨"
    }
  ]
}
```

**é”™è¯¯å“åº”** (400):

```json
{ "detail": "
  {'message': 'æ‰¹é‡å¤„ç†å¤±è´¥: æˆåŠŸ1æ¡ï¼Œå¤±è´¥2æ¡ï¼ˆä»…æ˜¾ç¤ºå‰5æ¡å¤±è´¥è¯¦æƒ…ï¼‰', 'success_count': 1, 'failed_count': 2, 'failed_numbers': ['002', '003'], 'failed_details': ['ç¬¬2ä¸ªäººç‰©(æå››_002): æœªæ£€æµ‹åˆ°æœ‰æ•ˆäººè„¸', 'ç¬¬3ä¸ªäººç‰©(ç‹äº”_003): æ£€æµ‹äººè„¸ç‰¹å¾å°ºå¯¸è¿‡å°']}"
}
```

**é”™è¯¯å“åº”å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| message | string | æ¦‚è¦ä¿¡æ¯ |
| success_count | int | æˆåŠŸå…¥åº“çš„æ•°é‡ |
| failed_count | int | å¤±è´¥çš„æ•°é‡ |
| failed_numbers | array | å¤±è´¥è®°å½•çš„ç¼–å·åˆ—è¡¨ |
| failed_details | array | å¤±è´¥è¯¦æƒ…ï¼ˆæœ€å¤š5æ¡ï¼‰ |

**å“åº”è¯´æ˜**ï¼š
- âœ… **å…¨éƒ¨æˆåŠŸ**ï¼šè¿”å› 200ï¼Œæ‰€æœ‰è®°å½•éƒ½æœ‰ `id` å’Œ `photo_path`
- âŒ **éƒ¨åˆ†å¤±è´¥**ï¼šè¿”å› 400ï¼ŒåŒ…å«å¤±è´¥ç»Ÿè®¡ã€å¤±è´¥ç¼–å·åˆ—è¡¨å’Œå‰5æ¡å¤±è´¥è¯¦æƒ…
- âŒ **å…¨éƒ¨å¤±è´¥**ï¼šè¿”å› 400ï¼ŒåŒ…å«æ‰€æœ‰å¤±è´¥è¯¦æƒ…ï¼ˆæœ€å¤š5æ¡ï¼‰

---

## æŸ¥è¯¢äººç‰©

### `GET /persons`

è·å–äººç‰©åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µã€‚

**æŸ¥è¯¢å‚æ•°**ï¼š

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| skip | int | 0 | è·³è¿‡çš„è®°å½•æ•° |
| limit | int | 100 | è¿”å›çš„è®°å½•æ•°ï¼ˆæœ€å¤§100ï¼‰ |

**è¯·æ±‚ç¤ºä¾‹**ï¼š

```
GET /persons?skip=0&limit=20
```

**æˆåŠŸå“åº”** (200):

```json
[
  {
    "id": "507f1f77bcf86cd799439011",
    "name": "å¼ ä¸‰",
    "number": "001",
    "photo_path": "/media/person_photos/å¼ ä¸‰_001_a3b4c5d6.jpg",
    "bbox": "100,50,200,250",
    "tip": "äººè„¸ç‰¹å¾åƒç´ æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨"
  },
  {
    "id": "507f1f77bcf86cd799439012",
    "name": "æå››",
    "number": "002",
    "photo_path": "/media/person_photos/æå››_002_b7c8d9e0.jpg",
    "bbox": "120,60,180,230",
    "tip": ""
  }
]
```

**å“åº”å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | string | MongoDBæ–‡æ¡£ID |
| name | string | äººç‰©å§“å |
| number | string | äººç‰©ç¼–å· |
| photo_path | string | äººè„¸å›¾ç‰‡è·¯å¾„ |
| bbox | string | äººè„¸æ£€æµ‹æ¡† (æ ¼å¼: "x,y,w,h") |
| tip | string | å›¾åƒè´¨é‡æç¤º |

**é”™è¯¯å“åº”**ï¼š

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 404 | æ•°æ®åº“ä¸ºç©ºï¼Œè¯·å…ˆåˆ›å»ºäººç‰© |
| 500 | æŸ¥è¯¢å¤±è´¥ |

---

## æœç´¢äººç‰©

### `POST /persons/search`

æ ¹æ®å§“åæˆ–ç¼–å·æœç´¢äººç‰©ã€‚

**åŠŸèƒ½è¯´æ˜**ï¼š
- åªä¼  `name`: æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆæ”¯æŒéƒ¨åˆ†åŒ¹é…ï¼‰
- åªä¼  `number`: ç²¾ç¡®æŸ¥è¯¢
- éƒ½ä¼ : ç»„åˆæŸ¥è¯¢ (nameæ¨¡ç³Š AND numberç²¾ç¡®)

**è¯·æ±‚ä½“**ï¼š

```json
{
  "name": "å¼ ",
  "number": "001"
}
```

**å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | å¦ | å§“åï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼Œå¿½ç•¥å¤§å°å†™ï¼‰ |
| number | string | å¦ | ç¼–å·ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰ |

**æ³¨æ„**ï¼šè‡³å°‘æä¾›ä¸€ä¸ªå‚æ•°

**è¯·æ±‚ç¤ºä¾‹**ï¼š

ä»…æŒ‰å§“åæ¨¡ç³Šæœç´¢ï¼š
```json
{
  "name": "å¼ "
}
```

ä»…æŒ‰ç¼–å·ç²¾ç¡®æœç´¢ï¼š
```json
{
  "number": "001"
}
```

ç»„åˆæœç´¢ï¼š
```json
{
  "name": "å¼ ",
  "number": "001"
}
```

**æˆåŠŸå“åº”** (200):

```json
{
  "persons": [
    {
      "id": "507f1f77bcf86cd799439011",
      "name": "å¼ ä¸‰",
      "number": "001",
      "photo_path": "/media/person_photos/å¼ ä¸‰_001_a3b4c5d6.jpg",
      "bbox": "100,50,200,250",
      "tip": "äººè„¸ç‰¹å¾åƒç´ æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨"
    }
  ]
}
```

**æœªæ‰¾åˆ°ç»“æœ**ï¼š

```json
{
  "persons": []
}
```

**é”™è¯¯å“åº”**ï¼š

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 400 | name å’Œ number è‡³å°‘æä¾›ä¸€ä¸ª |
| 500 | æœç´¢å¤±è´¥ |

---

## åˆ é™¤äººç‰©

### `DELETE /persons/delete`

é€šç”¨åˆ é™¤æ¥å£,æ”¯æŒæŒ‰ `number`(ç²¾ç¡®)ã€`name`(æ¨¡ç³Š) æˆ– `id`(ç²¾ç¡®) åˆ é™¤ã€‚

**è¯·æ±‚ä½“**ï¼š

æŒ‰ `number` ç²¾ç¡®åˆ é™¤ï¼ˆæ¨èï¼‰:
```json
{
  "number": "001"
}
```

æŒ‰ `name` æ¨¡ç³Šåˆ é™¤:
```json
{
  "name": "å¼ ä¸‰"
}
```

æŒ‰ `id` åˆ é™¤ï¼ˆå‘åå…¼å®¹ï¼‰:
```json
{
  "id": "507f1f77bcf86cd799439011"
}
```

**å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| number | string | å¦ | äººç‰©ç¼–å·ï¼ˆ**ç²¾ç¡®åŒ¹é…ï¼Œæ¨è**ï¼‰ |
| name | string | å¦ | å§“åï¼ˆ**æ¨¡ç³ŠåŒ¹é…ï¼Œä¸åŒºåˆ†å¤§å°å†™**ï¼‰ |
| id | string | å¦ | MongoDBæ–‡æ¡£IDï¼ˆç²¾ç¡®åŒ¹é…ï¼‰ |

**âš ï¸ é‡è¦è¯´æ˜**ï¼š
- **è‡³å°‘æä¾›ä¸€ä¸ªå‚æ•°**
- **ä¼˜å…ˆçº§**: `name` > `number` > `id`
- **æ¨èä½¿ç”¨ `number` å‚æ•°** - ç²¾ç¡®åŒ¹é…ï¼Œä¸ä¼šè¯¯åˆ 
- **name å‚æ•°ä½¿ç”¨æ¨¡ç³ŠåŒ¹é…**ï¼ˆMongoDB `$regex`ï¼‰
  - ä¾‹å¦‚ï¼š`name: "å¼ ä¸‰"` ä¼šåˆ é™¤"å¼ ä¸‰"ã€"å¼ ä¸‰ä¸°"ã€"å°å¼ ä¸‰"ç­‰æ‰€æœ‰åŒ…å«"å¼ ä¸‰"çš„è®°å½•
  - å¯èƒ½ä¸€æ¬¡åˆ é™¤å¤šæ¡è®°å½•

**æˆåŠŸå“åº”**ï¼š

æŒ‰ `name` æ¨¡ç³Šåˆ é™¤ï¼ˆå¯èƒ½åˆ é™¤å¤šæ¡ï¼‰:
```json
{
  "message": "æˆåŠŸåˆ é™¤ 2 ä¸ªäººç‰©",
  "info": [
    {
      "id": "507f1f77bcf86cd799439011",
      "number": "t123",
      "name": "å¼ ä¸‰"
    },
    {
      "id": "507f1f77bcf86cd799439012",
      "number": "t124",
      "name": "å¼ ä¸‰ä¸°"
    }
  ]
}
```

æŒ‰ `number` ç²¾ç¡®åˆ é™¤ï¼ˆåªåˆ é™¤ä¸€æ¡,ä½†è¿”å›æ•°ç»„æ ¼å¼ï¼‰:
```json
{
  "message": "æˆåŠŸåˆ é™¤ 1 ä¸ªäººç‰©",
  "info": [
    {
      "id": "507f1f77bcf86cd799439011",
      "number": "t123",
      "name": "å¼ ä¸‰"
    }
  ]
}
```

æŒ‰ `id` åˆ é™¤ï¼ˆåªåˆ é™¤ä¸€æ¡,ä½†è¿”å›æ•°ç»„æ ¼å¼ï¼‰:
```json
{
  "message": "æˆåŠŸåˆ é™¤ 1 ä¸ªäººç‰©",
  "info": [
    {
      "id": "507f1f77bcf86cd799439011",
      "number": "t123",
      "name": "å¼ ä¸‰"
    }
  ]
}
```

**é”™è¯¯å“åº”**ï¼š

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 400 | nameã€number å’Œ id è‡³å°‘æä¾›ä¸€ä¸ª |
| 404 | æœªæ‰¾åˆ°åŒ¹é…äººç‰© |
| 500 | åˆ é™¤æ“ä½œå¤±è´¥ |

---

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ç 

| çŠ¶æ€ç  | å«ä¹‰ | å¸¸è§åŸå›  |
|--------|------|---------|
| 400 | Bad Request | è¯·æ±‚å‚æ•°é”™è¯¯ã€å›¾ç‰‡æ•°æ®æ— æ•ˆ |
| 404 | Not Found | æœªæ‰¾åˆ°æŒ‡å®šèµ„æº |
| 422 | Unprocessable Entity | å›¾ç‰‡ä¸­æœªæ£€æµ‹åˆ°äººè„¸ã€äººè„¸è¿‡å° |
| 500 | Internal Server Error | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ã€æ•°æ®åº“é”™è¯¯ |

### é”™è¯¯å“åº”æ ¼å¼

æ‰€æœ‰é”™è¯¯éƒ½éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š

```json
{
  "detail": "é”™è¯¯æè¿°ä¿¡æ¯"
}
```

### å›¾ç‰‡è¦æ±‚

**æ”¯æŒæ ¼å¼**ï¼šJPG, PNG, BMP

**å°ºå¯¸è¦æ±‚**ï¼š
- æœ€å°äººè„¸å°ºå¯¸ï¼š80x80 åƒç´ 
- æ¨èå›¾ç‰‡åˆ†è¾¨ç‡ï¼šâ‰¥ 640x480

**è´¨é‡è¦æ±‚**ï¼š
- äººè„¸æ¸…æ™°å¯è§
- å…‰çº¿å……è¶³
- æ­£é¢æˆ–æ¥è¿‘æ­£é¢è§’åº¦
- æ— é®æŒ¡ï¼ˆå£ç½©ã€å¢¨é•œç­‰ï¼‰

---

## æœ€ä½³å®è·µ

### 1. åˆ›å»ºäººç‰©

```javascript
async function createPerson(name, number, photoBase64) {
  const response = await fetch('/persons', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name, number, photo: photoBase64 })
  });

  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.detail);
  }

  return await response.json();
}
```

### 2. æ‰¹é‡åˆ›å»º

```javascript
async function batchCreatePersons(persons) {
  const response = await fetch('/persons/batch', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ persons })
  });

  const result = await response.json();

  // æ£€æŸ¥å¤±è´¥çš„è®°å½•
  const failed = result.persons.filter(p => !p.id);
  if (failed.length > 0) {
    console.warn('éƒ¨åˆ†äººç‰©åˆ›å»ºå¤±è´¥:', failed);
  }

  return result;
}
```

### 3. æŒ‰ç¼–å·ç²¾ç¡®åˆ é™¤ï¼ˆæ¨èï¼‰

```javascript
async function deleteByNumber(number) {
  const response = await fetch('/persons/delete', {
    method: 'DELETE',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ number })
  });

  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.detail);
  }

  const result = await response.json();
  console.log(result.message); // "æˆåŠŸåˆ é™¤ 1 ä¸ªäººç‰©"
  console.log('åˆ é™¤çš„äººç‰©:', result.info);
  // [{ id: "507f1f77bcf86cd799439011", number: "001", name: "å¼ ä¸‰" }]
  return result;
}
```

### 4. æŒ‰å§“åæ¨¡ç³Šåˆ é™¤ï¼ˆæ…ç”¨ï¼‰

```javascript
async function deleteByName(name) {
  // è­¦å‘Šï¼šæ¨¡ç³ŠåŒ¹é…å¯èƒ½åˆ é™¤å¤šä¸ªäººç‰©
  const response = await fetch('/persons/delete', {
    method: 'DELETE',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name })
  });

  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.detail);
  }

  const result = await response.json();
  console.log(result.message); // "æˆåŠŸåˆ é™¤ 2 ä¸ªäººç‰©"
  console.log('åˆ é™¤çš„äººç‰©åˆ—è¡¨:', result.info);
  // info å§‹ç»ˆæ˜¯æ•°ç»„,æ— è®ºåˆ é™¤å‡ æ¡
  // [
  //   { id: "507f1f77bcf86cd799439011", number: "001", name: "å¼ ä¸‰" },
  //   { id: "507f1f77bcf86cd799439012", number: "002", name: "å¼ ä¸‰ä¸°" }
  // ]
  return result;
}
```

### 5. æœç´¢å¹¶åˆ é™¤

```javascript
async function searchAndDelete(keyword) {
  // å…ˆæœç´¢
  const searchResult = await fetch('/persons/search', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name: keyword })
  });

  const { persons } = await searchResult.json();

  if (persons.length === 0) {
    console.log('æœªæ‰¾åˆ°åŒ¹é…äººç‰©');
    return;
  }

  // æ˜¾ç¤ºæœç´¢ç»“æœå¹¶ç¡®è®¤
  console.log(`æ‰¾åˆ° ${persons.length} ä¸ªäººç‰©:`, persons);

  if (confirm(`ç¡®å®šåˆ é™¤è¿™äº›äººç‰©ï¼Ÿ`)) {
    // ä½¿ç”¨ number ç²¾ç¡®åˆ é™¤ç¬¬ä¸€ä¸ªç»“æœ
    const response = await fetch('/persons/delete', {
      method: 'DELETE',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ number: persons[0].number })
    });

    const result = await response.json();
    console.log('åˆ é™¤ç»“æœ:', result);
  }
}
```

---

## æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|------|------|---------|
| v4.0 | 2026-01-12 | **ç ´åæ€§å˜æ›´**: ç§»é™¤å†—ä½™æ¥å£ `/persons/by_name` å’Œ `/persons/by_id`,ç»Ÿä¸€ä½¿ç”¨ `/persons/delete` |
| v3.2 | 2026-01-12 | **é‡è¦ä¼˜åŒ–**: ç»Ÿä¸€æ‰€æœ‰åˆ é™¤æ¥å£çš„å“åº”æ ¼å¼,`info` å­—æ®µå§‹ç»ˆè¿”å›æ•°ç»„,é¿å…ç±»å‹ä¸ä¸€è‡´é—®é¢˜ |
| v3.1 | 2026-01-12 | ä¼˜åŒ– `/persons/delete` æ¥å£ï¼šæ”¯æŒæŒ‰ `number` ç²¾ç¡®åˆ é™¤ï¼Œè¿”å›è¯¦ç»†çš„åˆ é™¤ä¿¡æ¯ï¼ˆåŒ…å« idã€number å’Œ nameï¼‰ |
| v3.0 | 2026-01-12 | å®Œå…¨é‡å†™æ–‡æ¡£ï¼ŒåŸºäºæœ€æ–°ä»£ç æ›´æ–°æ‰€æœ‰æ¥å£è¯´æ˜ |
| v2.1 | 2026-01-09 | è¡¥å……é€šç”¨åˆ é™¤æ¥å£è¯´æ˜ä¸å“åº”ç¤ºä¾‹ |
| v2.0 | 2026-01-07 | ä¼˜åŒ–åˆ é™¤æ¥å£ï¼Œæ·»åŠ å®‰å…¨è­¦å‘Š |
| v1.0 | - | åˆå§‹ç‰ˆæœ¬ |

---

## ç›¸å…³æ–‡æ¡£

- [RECOGNIZE_API.md](./RECOGNIZE_API.md) - äººè„¸è¯†åˆ«æ¥å£æ–‡æ¡£
- [DEPLOYMENT.md](./DEPLOYMENT.md) - éƒ¨ç½²è¯´æ˜æ–‡æ¡£
